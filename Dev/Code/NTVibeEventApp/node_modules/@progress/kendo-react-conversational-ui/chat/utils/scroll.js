/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2025 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("react");function _(c){const d=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(c){for(const r in c)if(r!=="default"){const f=Object.getOwnPropertyDescriptor(c,r);Object.defineProperty(d,r,f.get?f:{enumerable:!0,get:()=>c[r]})}}return d.default=c,Object.freeze(d)}const n=_(m),A=50,x=250,T=50,B=100,N=({viewItemsWrapperRef:c,isKeyboardNavigationActiveRef:d,processedMessages:r,suggestions:f})=>{const i=n.useCallback(()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight-c.current.clientHeight)},[c]),u=n.useCallback(()=>{if(!c.current)return!0;const t=c.current,{scrollTop:e,scrollHeight:l,clientHeight:s}=t,a=A+25;return l-e-s<a},[c]),b=n.useCallback(t=>t===0?16:t<=2?32*t:Math.min(50*t,200),[]),S=n.useCallback((t,e)=>{const l=b(t);setTimeout(()=>{!u()&&c.current&&e(t+1)},l)},[b,u,c]),h=n.useCallback(()=>{const t=(e=0)=>{e>5||requestAnimationFrame(()=>{i(),S(e,t)})};t()},[i,S]),C=n.useCallback(()=>{i(),setTimeout(()=>{!u()&&c.current&&i()},50)},[i,u,c]),y=n.useCallback(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(C)})})},[C]),O=n.useCallback(()=>{i(),setTimeout(()=>{!u()&&c.current&&h()},25)},[i,u,c,h]),o=n.useCallback((t=!1)=>{if(!c.current||d.current)return;u()&&(t?O():y())},[u,O,y,c,d]);n.useEffect(()=>{const t=window.setTimeout(()=>i(),x);return()=>{clearTimeout(t)}},[i]),n.useEffect(()=>{h()},[r.length,h]),n.useEffect(()=>{const t=window.setTimeout(()=>{o()},T);return()=>{clearTimeout(t)}},[r,o]),n.useEffect(()=>{if(r.length>0){const t=r[r.length-1],e=(t==null?void 0:t.text)||"";(e.includes("```")||e.includes(`

`)||e.includes("<pre>")||e.includes("<code>")||e.includes("<table>")||e.length>500)&&o(!0)}},[r,o]),n.useEffect(()=>{if(f&&f.length>0){const t=window.setTimeout(()=>{o()},B);return()=>{clearTimeout(t)}}},[f,o]),n.useEffect(()=>{if(!c.current)return()=>{};let t;const e=new ResizeObserver(()=>{t&&clearTimeout(t),t=window.setTimeout(()=>{o()},T)}),l=c.current.querySelector(".k-message-list-content");return l&&e.observe(l),()=>{e.disconnect()}},[o,c]);const g=n.useCallback(t=>{var l;if(t.type!=="characterData"&&t.type!=="childList")return!1;const e=(l=t.target.textContent)!=null?l:"";return e.includes("```")||e.includes(`

`)||e.includes("<pre>")||e.includes("<code>")||e.includes("<table>")||t.addedNodes&&t.addedNodes.length>2},[]),L=n.useCallback(t=>{let e=!1,l=!1;return t.forEach(s=>{var a;(s.type==="childList"||s.type==="characterData"||s.type==="attributes"&&["class","style"].includes((a=s.attributeName)!=null?a:""))&&(e=!0,g(s)&&(l=!0))}),{shouldScroll:e,hasSignificantChange:l}},[g]),k=n.useCallback((t,e)=>{e.current&&clearTimeout(e.current),t?o(!0):e.current=window.setTimeout(()=>{o()},T)},[o]);n.useEffect(()=>{if(!c.current)return()=>{};const t={current:void 0};let e=0;const l=new MutationObserver(s=>{const a=Date.now();if(a-e<16)return;e=a;const{shouldScroll:E,hasSignificantChange:D}=L(s);E&&u()&&k(D,t)});return l.observe(c.current,{childList:!0,subtree:!0,characterData:!0,attributes:!0,attributeFilter:["class","style"]}),()=>{l.disconnect(),t.current&&clearTimeout(t.current)}},[u,L,k,c])};exports.useChatScroll=N;
